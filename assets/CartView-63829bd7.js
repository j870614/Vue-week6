import{_ as k,r as g,o as r,c as d,b as e,F as v,f as x,h as f,t as i,d as n,w as I,e as C,g as y,v as q,i as b,j as w}from"./index-23b742f9.js";const m="https://vue3-course-api.hexschool.io/",u="hironakavue",U={data(){return{cart:{},form:{user:{name:"",tel:"",address:""},message:""},loadingItem:""}},mounted(){this.getCart()},methods:{getCart(){const l=this.$loading.show();this.$http.get(`${m}/v2/api/${u}/cart`).then(t=>{this.cart=t.data.data,l.hide()}).catch(t=>{l.hide(),alert(t.response.data.message),l.hide()})},removeCartItem(l){this.loadingItem=l,this.$http.delete(`${m}/v2/api/${u}/cart/${l}`).then(t=>{alert(t.data.message),this.loadingItem="",this.getCart()}).catch(t=>{alert(t.response.data.message)})},deleteAllCarts(){this.$http.delete(`${m}/v2/api/${u}/carts`).then(l=>{alert(l.data.message),this.getCart()}).catch(l=>{alert(l.data.message)})},updateCart(l){this.loadingItem=l.id;const t={data:{product_id:l.product_id,qty:l.qty}};this.$http.put(`${m}/v2/api/${u}/cart/${l.id}`,t).then(h=>{alert(h.data.message),this.loadingItem="",this.getCart()}).catch(h=>{alert(h.response.data.message)})},sendOrder(){const l={data:this.form};this.$http.post(`${m}/v2/api/${u}/order`,l).then(t=>{alert(t.data.message),this.$refs.form.resetForm(),this.form.message="",this.getCart()}).catch(t=>{alert(t.response.data.message)})}}},N={class:"text-end"},S={class:"table align-middle"},A=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),B=["onClick","disabled"],E={key:0,class:"text-success"},F={class:"input-group input-group-sm"},$={class:"input-group mb-3"},j=["onUpdate:modelValue","onChange","disabled"],D=["value"],M={class:"input-group-text",id:"basic-addon2"},O={class:"text-end"},T={key:0,class:"text-success"},z=e("td",{colspan:"3",class:"text-end"},"總計",-1),L={class:"text-end"},G={key:0},H=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),J={class:"text-end text-success"},K={class:"my-5 row justify-content-center"},P={class:"mb-3"},Q=e("label",{for:"email",class:"form-label"},"Email",-1),R={class:"mb-3"},W=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),X={class:"mb-3"},Y=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),Z={class:"mb-3"},ee=e("label",{for:"address",class:"form-label"},"收件人地址",-1),te={class:"mb-3"},se=e("label",{for:"message",class:"form-label"},"留言",-1),le=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function ae(l,t,h,oe,s,c){const _=g("v-field"),p=g("error-message"),V=g("v-form");return r(),d("div",null,[e("div",N,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...a)=>c.deleteAllCarts&&c.deleteAllCarts(...a))}," 清空購物車 ")]),e("table",S,[A,e("tbody",null,[s.cart.carts?(r(!0),d(v,{key:0},x(s.cart.carts,a=>(r(),d("tr",{key:a.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>c.removeCartItem(a.id),disabled:s.loadingItem===a.id}," x ",8,B)]),e("td",null,[C(i(a.product.title)+" ",1),a.coupon?(r(),d("div",E,"已套用優惠券")):f("",!0)]),e("td",null,[e("div",F,[e("div",$,[y(e("select",{class:"form-control","onUpdate:modelValue":o=>a.qty=o,onChange:o=>c.updateCart(a),disabled:s.loadingItem===a.id},[(r(),d(v,null,x(20,o=>e("option",{value:o,key:o},i(o),9,D)),64))],40,j),[[q,a.qty,void 0,{number:!0}]]),e("span",M,i(a.product.unit),1)])])]),e("td",O,[s.cart.final_total!==s.cart.total?(r(),d("small",T,"折扣價：")):f("",!0),C(" $ "+i(a.total),1)])]))),128)):f("",!0)]),e("tfoot",null,[e("tr",null,[z,e("td",L,"$ "+i(s.cart.total),1)]),s.cart.final_total!==s.cart.total?(r(),d("tr",G,[H,e("td",J,"$ "+i(s.cart.final_total),1)])):f("",!0)])]),e("div",K,[n(V,{ref:"form",class:"col-md-6",onSubmit:c.sendOrder},{default:I(({errors:a})=>[e("div",P,[Q,n(_,{id:"email",name:"email",type:"email",class:b(["form-control",{"is-invalid":a.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:s.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=o=>s.form.user.email=o)},null,8,["class","modelValue"]),n(p,{name:"email",class:"invalid-feedback"})]),e("div",R,[W,n(_,{id:"name",name:"姓名",type:"text",class:b(["form-control",{"is-invalid":a.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=o=>s.form.user.name=o)},null,8,["class","modelValue"]),n(p,{name:"姓名",class:"invalid-feedback"})]),e("div",X,[Y,n(_,{id:"tel",name:"電話",type:"number",class:b(["form-control",{"is-invalid":a.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:s.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=o=>s.form.user.tel=o)},null,8,["class","modelValue"]),n(p,{name:"電話",class:"invalid-feedback"})]),e("div",Z,[ee,n(_,{id:"address",name:"地址",type:"text",class:b(["form-control",{"is-invalid":a.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=o=>s.form.user.address=o)},null,8,["class","modelValue"]),n(p,{name:"地址",class:"invalid-feedback"})]),e("div",te,[se,y(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=o=>s.form.message=o)},null,512),[[w,s.form.message]])]),le]),_:1},8,["onSubmit"])])])}const re=k(U,[["render",ae]]);export{re as default};
